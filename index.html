<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>高知お散歩ルートメーカー</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
    }
    #controls {
      padding: 10px;
      background: #f0f8f5;
    }
    #map {
      width: 100%;
      height: 80vh;
    }
    select, button {
      margin-right: 10px;
      padding: 6px;
    }
  </style>
</head>
<body>

<div id="controls">
  <label>
    気分：
    <select id="mood">
      <option value="relax">のんびり</option>
      <option value="nature">自然</option>
      <option value="city">街歩き</option>
    </select>
  </label>

  <label>
    距離：
    <select id="distance">
      <option value="1">1km</option>
      <option value="3">3km</option>
      <option value="5">5km</option>
    </select>
  </label>

  <button onclick="generateRoute()">ルートを決める</button>
</div>

<div id="map"></div>

<script>
const GOOGLE_MAPS_API_KEY = "YOUR_API_KEY";

let map;
let directionsService;
let directionsRenderer;

// 高知県内の候補スポット
const spots = {
  relax: [
    { name: "高知城", lat: 33.5597, lng: 133.5311 },
    { name: "鏡川", lat: 33.5535, lng: 133.5207 }
  ],
  nature: [
    { name: "桂浜", lat: 33.4968, lng: 133.5714 },
    { name: "四万十川", lat: 32.9907, lng: 132.9335 }
  ],
  city: [
    { name: "はりまや橋", lat: 33.5586, lng: 133.5415 },
    { name: "高知駅", lat: 33.5662, lng: 133.5431 }
  ]
};

function initMap() {
  map = new google.maps.Map(document.getElementById("map"), {
    center: { lat: 33.5597, lng: 133.5311 },
    zoom: 13
  });

  directionsService = new google.maps.DirectionsService();
  directionsRenderer = new google.maps.DirectionsRenderer();
  directionsRenderer.setMap(map);
}

function generateRoute() {
  const mood = document.getElementById("mood").value;
  const distanceKm = Number(document.getElementById("distance").value);

  const candidates = spots[mood];
  const start = candidates[Math.floor(Math.random() * candidates.length)];

  // ランダムに少しずらしたゴールを作る
  const delta = distanceKm * 0.005;
  const goal = {
    lat: start.lat + (Math.random() - 0.5) * delta,
    lng: start.lng + (Math.random() - 0.5) * delta
  };

  directionsService.route(
    {
      origin: start,
      destination: goal,
      travelMode: google.maps.TravelMode.WALKING
    },
    (result, status) => {
      if (status === "OK") {
        directionsRenderer.setDirections(result);
      } else {
        alert("ルートを生成できませんでした");
      }
    }
  );
}
</script>

<script async
  src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap">
</script>

</body>
</html>

